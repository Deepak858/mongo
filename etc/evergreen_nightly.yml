# Similar to etc/evergreen.yml, but for release builds.

include:
  - filename: etc/evergreen_yml_components/configuration.yml
  - filename: etc/evergreen_yml_components/definitions.yml

  - filename: etc/evergreen_yml_components/tasks/resmoke/server_divisions/clusters_and_integrations/tasks.yml
  - filename: etc/evergreen_yml_components/tasks/resmoke/server_divisions/durable_transactions_and_availability/tasks.yml
  - filename: etc/evergreen_yml_components/tasks/resmoke/server_divisions/query/tasks.yml
  - filename: etc/evergreen_yml_components/tasks/resmoke/non_server_teams/tasks.yml
  - filename: etc/evergreen_yml_components/tasks/compile_tasks.yml
  - filename: etc/evergreen_yml_components/tasks/compile_tasks_shared.yml
  - filename: etc/evergreen_yml_components/tasks/compile_tasks_nightly.yml
  - filename: etc/evergreen_yml_components/tasks/misc_tasks.yml

  - filename: etc/evergreen_yml_components/variants/misc/task_generation.yml
  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/misc/misc.yml

  - filename: etc/evergreen_yml_components/variants/amazon/test_release.yml
  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/amazon/test_dev.yml

  - filename: etc/evergreen_yml_components/variants/debian/test_release.yml

  ### Comment out when using this file for a Rapid release branch. ###
  # - filename: etc/evergreen_yml_components/variants/ibm/test_release_master_and_lts_branches_only.yml

  - filename: etc/evergreen_yml_components/variants/macos/test_release.yml

  - filename: etc/evergreen_yml_components/variants/rhel/test_release.yml
  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/rhel/test_dev.yml
  ### Uncomment when using this file for a LTS release branch. ###
  - filename: etc/evergreen_yml_components/variants/rhel/test_dev_master_and_lts_branches_only.yml

  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/sanitizer/test_dev.yml

  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/mongot/test_dev.yml

  - filename: etc/evergreen_yml_components/variants/suse/test_release.yml

  - filename: etc/evergreen_yml_components/variants/ubuntu/test_release.yml
  ### Uncomment when using this file for a LTS release branch. ###
  - filename: etc/evergreen_yml_components/variants/ubuntu/test_dev_master_and_lts_branches_only.yml

  - filename: etc/evergreen_yml_components/variants/windows/test_release.yml
  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/windows/test_dev.yml
  ### Uncomment when using this file for a LTS release branch. ###
  - filename: etc/evergreen_yml_components/variants/windows/test_dev_master_and_lts_branches_only.yml

  - filename: etc/evergreen_yml_components/tasks/coverity_tasks.yml
  - filename: etc/evergreen_yml_components/variants/coverity.yml
  - filename: etc/evergreen_yml_components/tasks/release_tasks.yml
  ### Uncomment when using this file for a LTS or Rapid release branch. ###
  - filename: etc/evergreen_yml_components/variants/release/release.yml

parameters:
  - key: evergreen_config_file_path
    value: "etc/evergreen_nightly.yml"
    description: "path to this file"

commit_queue_aliases:
  - variant: "commit-queue"
    task: "^(bazel_.*|run_.*|unit_test_group.*|compile_.*|lint_.*|jsCore|check_for_noexcept|version_gen_validation|validate_commit_message|resmoke_validation_tests|buildscripts_test)$"
    variant_tags: []
    task_tags: []
  - variant: "^(amazon-linux2023-arm64-static-compile|linux-x86-dynamic-compile-required)$"
    variant_tags: []
    task_tags: ["clang_tidy"]
  - variant: "^(al2023-arm64-sep-benchmark)$"
    variant_tags: []
    task_tags: ["benchmarks_sep"]

github_pr_aliases:
  - variant: "commit-queue"
    task: "^(bazel_.*|run_.*|unit_test_group.*|compile_.*|lint_.*|jsCore|check_for_noexcept|version_gen_validation|validate_commit_message|resmoke_validation_tests|buildscripts_test)$"
    variant_tags: []
    task_tags: []
  - variant: "^(amazon-linux2023-arm64-static-compile|linux-x86-dynamic-compile-required)$"
    variant_tags: []
    task_tags: ["clang_tidy"]
  - variant: "^(al2023-arm64-sep-benchmark)$"
    variant_tags: []
    task_tags: ["benchmarks_sep"]

patch_aliases:
  - alias: required
    variant_tags: ["required"]
    task: ".*"
  - alias: query
    variant: "^(.*query-patch-only|amazon-linux2023-arm64-static-compile)$"
    task: ".*"
  - alias: query-quick
    variant: "^(.*query-quick-patch-only|linux-x86-dynamic-compile)$"
    task: ".*"
  - alias: security
    variant: "^(.*security-patch-only|linux-x86-dynamic-compile|windows-compile-required)$"
    task: ".*"
  - alias: bazel
    description: "Runs bazel build system tests"
    variant_tags: ["bazel_check"]
    task_tags: ["bazel_check"]
  - alias: bazel_variants
    description: "Runs bazel build system tests"
    variant_tags: ["bazel_check"]
    task: ".*"
  - alias: search
    description: "Runs all $search, $vectorSearch tests"
    variant: ".*"
    task: "^.*search*"
  - alias: required-and-mongot-e2e-tests
    description: >
      This alias selects all tasks in all required variants and all tasks in variants that use a real mongot.
      Once more e2e tests have been contributed and thus our coverage is better, this alias can be refined
      to only select tests that use a real mongot.
    variant_tags: ["required", "mongot_e2e"]
    task: ".*"
  - alias: codecoverage
    description: "Run tests and report code coverage"
    variant: ".*-coverage"
    task: ".*"
  - alias: unittestcoverage
    description: "Run unit tests and report code coverage"
    variant: ".*-coverage"
    task: "^(unit_test_group.*|bazel_coverage)$"
  - alias: cluster_scalability
    variant_tags: ["cluster_scalability_only"]
    task_tags: ["cluster_scalability_only"]
